--@/home/fulcrum/BSUIR/MDISUBD/LR2/create.sql

CREATE TABLE GROUPS (
  ID    NUMBER PRIMARY KEY,
  NAME  VARCHAR2(100) NOT NULL,
  C_VAL NUMBER DEFAULT 0 NOT NULL
  CONSTRAINT check_c_val CHECK (C_VAL >= 0)
);

CREATE TABLE STUDENTS (
  ID       NUMBER PRIMARY KEY,
  NAME     VARCHAR2(100) NOT NULL,
  GROUP_ID NUMBER,
  CONSTRAINT FK_GROUP FOREIGN KEY (GROUP_ID) REFERENCES GROUPS(ID)
);


CREATE TABLE STUDENTS_LOG (
  LOG_ID      NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  STUDENT_ID  NUMBER,
  OPERATION   VARCHAR2(10),
  CHANGED_AT  TIMESTAMP DEFAULT SYSTIMESTAMP,
  OLD_NAME    VARCHAR2(100),
  NEW_NAME    VARCHAR2(100),
  OLD_GROUP   NUMBER,
  NEW_GROUP   NUMBER
);